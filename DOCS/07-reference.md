# API style reference

## tracktorlive.spawn_trserver(...)
This function returns a TracktorServer object. The function takes the following
arguments:

| argument           | type                 | description                                                                                              |
| ------------------ | -------------------- | -------------------------------------------------------------------------------------------------------- |
| `vidinput`         | int or str           | Either an integer referring to a camera ID, or a string describing a path to a video file.               |
| `params`           | dict                 | All parameters used by Tracktor. Output as JSON by `tracktorlive gui`.                                   |
| `n_ind`            | int (default 1)      | Number of individuals to be tracked.                                                                     |
| `buffer_size`      | int (default 10)     | How many seconds of data should be stored in memory.                                                     |
| `draw`             | bool (default False) | Whether contours and detected centroids should be drawn on the detected objects.                         |
| `feed_id`          | str (default None)   | A unique identifier for this instance to the TracktorServer. If None, a unique random ID will be chosen. |
| `keep_recordings`  | bool (default False) | Flag whether to store tracking outputs in separate long-term memory.                                     |
| `keep_video`       | bool (default False) | Flag whether to store video frames in separate long-term memory.                                         |
| `realtime`         | bool (default True)  | Whether current input is realtime or prerecorded.                                                        |
| `timeout`          | int (default inf)    | How many seconds to wait before server is shut down.                                                     |
| `use_kmeans`       | bool (default True)  | Whether to use the k-means algorithm to clean up centroids.                                              |
| `write_recordings` | bool (default False) | Flag whether to write recorded tracking data to a CSV file on-the-fly.                                   |
| `write_video`      | bool (default False) | Flag whether to write video frames to an MP4 file on-the-fly.                                            |
| `width`            | int (default 640)    | Width of input video frames.                                                                             |
| `height`           | int (default 480)    | Height of input video frames.                                                                            |

All arguments whose descriptions says `Flag` above are available to be set by
casettes to change server behaviour. Other relevant flags include `framesbuffer`: a
list of all previous frames in the last `buffer_size` seconds; and
`running.value`, which when set to False will halt the server.
The above function, `spawn_trserver` spawns a TracktorServer (tracktorlive.server.Server) object and a semaphore manager.
The TracktorServer allows the following methods:

| method                      | description                                                      |
| --------------------------- | ---------------------------------------------------------------- |
| `get_data_and_clock()`      | Get data and clock buffers.                                      |
| `get_clients()`             | Get list of available clients listening to this server.          |
| `dumpvideo(outfile, codec)` | Parallelly write long videos generated by the flag `keep_video`. |


## tracktorlive.spawn_trclient(...)
This function returns a TracktorClient object. The function takes the following
arguments:

| argument       | type                  | description                                                            |
| -------------- | --------------------- | ---------------------------------------------------------------------- |
| `feed_id`      | str                   | `feed_id` of the server to which the client must connect.              |
| `run_interval` | float (default 0.005) | How many seconds to wait between successive calls of client functions. |


## tracktorlive.run_trsession(...)
This function is the main call to run a session with TracktorLive.
The arguments your will need are

| argument       | type                   | description                                                            |
| -------------- | ---------------------- | ---------------------------------------------------------------------- |
| `server `      | TracktorServer         | A server object returned by spawn_trserver(...), see above.            |
| `semm`         | SemaphoreManager       | A semaphore manager object returned by spawn_trserver, see above.      |
| `clients`      | None or TracktorClient | A client (or list of clients) from spawn_trclient, see above.          |

One other useful functions you may need during this entire process is
`tracktorlive.list_feeds()`, to find which servers are actively tracking.

[previous](06-usage.md) | [next]()
